---
title: Use Azure Application Insights
description: Configure Application Insights to capture custom logs, performance data, and availability metrics about Data API builder for analysis and troubleshooting.
author: seesharprun
ms.author: sidandrews
ms.reviewer: jerrynixon
ms.service: data-api-builder
ms.topic: how-to
ms.date: 04/09/2024
# Customer Intent: As a developer, I want to integrate Application Insights with Data API builder, so that I can capture performance metrics.
---

# Use Azure Application Insights in Data API builder

Azure Application Insights is a service provided by Microsoft Azure that enables developers to monitor and gain insights into the performance and usage of their applications. The guide illustrates how to enable Application Insights for Data API builder (DAB). With Application Insights, you can track application availability, response times, performance metrics, user behavior, and other useful metrics.

## Prerequisites

- A running solution using Data API builder

> [!WARNING]
> Application Insights for Data API builder is not supported when hosting Data API builder in Azure App Service web apps.

## Update configuration file

First, you should add an `application-insights` section to your existing configuration file. This section includes the credentials necessary to connect DAB to Application Insights.

1. Locate and open the existing configuration file for your DAB solution.

1. In the `runtime` section, of the configuration file, add a `telemetry` section with the following properties.

    | | Description |
    | --- | --- |
    | **`enabled`** | Enables or disables application insights |
    | **`connection-string`** | Connection string for Application Insights instance |

    **Use the Data API builder CLI**

    You can directly edit the configuration JSON or use the command line interface to do it. 

    ```bash
    dab add-telemetry
      --app-insights-enabled true
      --app-insights-conn-string "@env('app-insights-connection-string')"
    ```

    **Update the dab-config.json file**

    The `telemetry` property in the configuration JSON is a child of the `runtime` property. 

    ```json
    {
      "runtime": {
        ...
        "telemetry": {
          "application-insights": {
            "enabled": true,
            "connection-string": "@env('app-insights-connection-string')"
          }
        }
      }
    }
    ```

    > [!NOTE]
    > This sample assumes the environment variable named 'app-insights-connection-string' holds your Application Insights connection string. To get your connection string, open the Azure portal and navigate to the Application Insights blade after you have added the service.

1. Save the configuration file (if you edited the JSON) and restart your solution.

## Review metrics

When you enable Application Insights in your application, it starts sending data to the Application Insights service immediately.

1. Navigate to the Application Insights resource in the Azure portal (<https://portal.azure.com>).

1. Review the following types of data captured by Application Insights about your DAB solution.

    | | Description |
    | --- | --- |
    | **Request telemetry** | Information about each incoming request to DAB, such as the URL, response time, and status code |
    | **Trace telemetry** | Logs generated by DAB |
    | **Exception telemetry** | Information about any exceptions or errors that occur in DAB |
    | **Performance counters** | Metrics related to the performance of DAB, such as CPU usage, memory usage, and network traffic |

    > [!NOTE]
    > The logs that are sent to Application Insights are same as the logs printed by Data API builder in the console.

1. Navigate to the **Logs** section of the Application Insights page. Review the logs using this query.

    ```kusto
    traces
    | order by timestamp
    ```

1. Review the results of the query. The `LogLevel` is mapped to severity levels using this table.

    | LogLevel | Severity Level | Severity Level Value |
    | --- | --- | --- |
    | Trace | Verbose | 0 |
    | Debug | Verbose | 0 |
    | Information | Information | 1 |
    | Warning | Warning | 2 |
    | Error | Error | 3 |
    | Critical | Critical | 4 |

    > [!TIP]
    > Set the current log level using the `--LogLevel` option for the DAB command-line interface (CLI). Otherwise, the host mode in the config file determines the minimum loglevel. If the host mode is set to `Production`, the minimum log level is `Error`. For the `Development` host mode, the minimum log level is `Debug`.

1. Navigate to the **Live Metrics** page.

    :::image type="content" source="media/how-to-use-application-insights/live-metrics.png" lightbox="media/how-to-use-application-insights/live-metrics.png" alt-text="Screenshot of the live metrics page for Data API builder data in Application Insights.":::

1. Check the **Application Requests** using this query.

    ```kusto
    requests
    | order by timestamp
    ```

    :::image type="content" source="media/how-to-use-application-insights/requests-results.png" lightbox="media/how-to-use-application-insights/requests-results.png"  alt-text="Screenshot of the results of a query for Data API builder application requests in Application Insights.":::

1. Enumerate exceptions using the **Application Exceptions** page.

    ```kusto
    exceptions
    | order by timestamp
    ```

    :::image type="content" source="media/how-to-use-application-insights/exceptions-results.png" lightbox="media/how-to-use-application-insights/exceptions-results.png" alt-text="Screenshot of the results of a query for Data API builder exceptions in Application Insights.":::

## Related content

- [Azure Application Insights](/azure/azure-monitor/app/app-insights-overview)
- [Configuration file reference](reference-configuration.md)
- [Tutorial: Run Data API builder in Azure Container Apps](running-in-azure.md)
